% !TEX root = ./CCC_Note.tex

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}
%\usepackage{datetime}
\usepackage[T1]{fontenc}
\usepackage[sc]{mathpazo}
\linespread{1.05}
\usepackage{mathrsfs}
\usepackage{euscript}
%\usepackage{MnSymbol}
\usepackage{paralist}
\usepackage{todonotes}
\usepackage{makecell}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{cd}
\usepackage{hyperref}
\usepackage{tensor}

\usetikzlibrary{decorations.markings,arrows.meta,calc,fit,quotes}
\hypersetup{final}

\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\cod}{cod}
\DeclareMathOperator{\dvert}{Vert}
\DeclareMathOperator{\Lax}{Lax}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Prof}{Prof}
\DeclareMathOperator{\MProf}{MProf}
\DeclareMathOperator{\Int}{Int}
\DeclareMathOperator{\Ob}{Ob}
\DeclareMathOperator{\Tr}{Tr}


\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{exercise}{Exercise}[section]

\theoremstyle{remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}

\newcommand{\prodb}{\mathbin{\Pi}}
\newcommand{\iso}{\cong}

\newcommand{\cat}[1]{\mathscr{#1}}
\newcommand{\Cat}[1]{\mathbf{#1}}
%\newcommand{\hom}{\mathrm{hom}}
\newcommand{\twocat}[1]{\mathcal{#1}}
\newcommand{\dblcat}[1]{\mathbb{#1}}
\newcommand{\btwo}{\mathbf{2}}
\newcommand{\FF}{\mathbb{F}\Cat{F}}
\newcommand{\FFD}{\FF(\dblcat{D})}
\newcommand{\Mon}{\Cat{Mon}}
\newcommand{\DMon}{\mathbb{M}\Cat{on}}
\newcommand{\Comon}{\Cat{Comon}}
\newcommand{\DComon}{\mathbb{C}\Cat{omon}}
\newcommand{\Bimon}{\Cat{Bimon}}
\newcommand{\Sq}{\mathbb{S}\Cat{q}}
\newcommand{\Span}{\mathbb{S}\Cat{pan}}
\newcommand{\Hor}{\twocat{H}or}
\newcommand{\LAdj}{\dblcat{L}\Cat{Adj}}
\newcommand{\RAdj}{\dblcat{R}\Cat{Adj}}
\newcommand{\MAdjC}{\Cat{MAdj}}
\newcommand{\MAdj}{\dblcat{M}\Cat{Adj}}
\newcommand{\EAdj}{\dblcat{E}\Cat{Adj}}
\newcommand{\SymMonCat}{\Cat{SymMonCat}}
\newcommand{\CompCat}{\Cat{CompCat}}
\newcommand{\Set}{\Cat{Set}}

\newcommand{\op}[1]{{#1}^{\text{op}}}
\newcommand{\vop}[1]{{#1}^{\text{vop}}}
\newcommand{\hop}[1]{{#1}^{\text{hop}}}

\newcommand{\Alg}{\mathrm{Alg}}
\newcommand{\Coalg}{\mathrm{Coalg}}
\newcommand{\RAlg}[1][]{\mathbb{R}_{#1}\text{-}\Alg}
\newcommand{\LCoalg}[1][]{\mathbb{L}_{#1}\text{-}\Coalg}
\newcommand{\LCoalgA}{\mathbb{L}_1\text{-}\Coalg}
\newcommand{\LCoalgB}{\mathbb{L}_2\text{-}\Coalg}

\newcommand{\twocell}[3][]{\arrow[draw=none,to path={(dom#2.center)--(cod#2.center)\tikztonodes}]{}[anchor=center,#1]{\Downarrow #3}}
\newcommand{\twocellalt}[3][]{\arrow[draw=none,to path={(dom#2.center)--(cod#2.center)\tikztonodes}]{}[anchor=center,#1]{#3}}
\newcommand{\twocellA}[2][]{\twocell[#1]{A}{#2}}
\newcommand{\twocellB}[2][]{\twocell[#1]{B}{#2}}
\newcommand{\twocellC}[2][]{\twocell[#1]{C}{#2}}
\newcommand{\twocellD}[2][]{\twocell[#1]{D}{#2}}
\newcommand{\twocellE}[2][]{\twocell[#1]{E}{#2}}
\newcommand{\twocellF}[2][]{\twocell[#1]{F}{#2}}

\tikzcdset{
	arrow style=tikz,
	diagrams={>={Classical TikZ Rightarrow[angle=63:4pt, line width=.6pt]}},
	arrows={semithick}
}

\tikzset{tick/.style={postaction={decorate,decoration={markings,mark=at position 0.5 with {\draw[-] (0,.4ex) -- (0,-.4ex);}}}}}
\tikzset{dom/.style={append after command={coordinate[alias=dom#1]}},
		domA/.style={dom=A}, domB/.style={dom=B},
		domC/.style={dom=C}, domD/.style={dom=D},
		domE/.style={dom=E}, domF/.style={dom=F}}
\tikzset{cod/.style={append after command={coordinate[alias=cod#1]}},
		codA/.style={cod=A}, codB/.style={cod=B},
		codC/.style={cod=C}, codD/.style={cod=D},
		codE/.style={cod=E}, codF/.style={cod=F}}


\tikzset{
	%label/.style={font=\everymath\expandafter{\the\everymath\scriptstyle}},
	wiring diagram/.style={
		every to/.style={out=0,in=180,draw},
		label/.style={
			font=\everymath\expandafter{\the\everymath\scriptstyle},
			inner sep=0pt,
			node distance=1pt and -2pt},
		semithick,
		node distance=1 and 1,
		decoration={markings, mark=at position .5 with {\arrow{stealth};}},
		ar/.style={postaction={decorate}},
		execute at begin picture={\tikzset{
			x=\bbx, y=\bby,
			every fit/.style={inner xsep=\bbx, inner ysep=\bby}}}
		},
	bbx/.store in=\bbx,
	bbx = 2cm,
	bby/.store in=\bby,
	bby = 1.75ex,
	bb port sep/.store in=\bbportsep,
	bb port sep=2,
	% bb wire sep/.store in=\bbwiresep,
	% bb wire sep=1.75ex,
	bb port length/.store in=\bbportlen,
	bb port length=4pt,
	bb min width/.store in=\bbminwidth,
	bb min width=.8cm,
	bb small/.style={bb port sep=1, bb port length=2.5pt, bbx=.4cm, bb min width=.4cm, bby=.7ex},
	bb/.code 2 args={
		\pgfmathsetlengthmacro{\bbheight}{\bbportsep * (max(#1,#2)+1) * \bby}
		\pgfkeysalso{draw,minimum height=\bbheight,minimum width=\bbminwidth,outer sep=0pt,
			rounded corners=2pt,thick,
			prefix after command={\pgfextra{\let\fixname\tikzlastnode}},
			append after command={\pgfextra{\draw
				\ifnum #1=0{} \else foreach \i in {1,...,#1} {
					($(\fixname.north west)!{\i/(#1+1)}!(\fixname.south west)$) +(-\bbportlen,0) coordinate (\fixname_in\i) -- +(\bbportlen,0) coordinate (\fixname_in\i')}\fi
				\ifnum #2=0{} \else foreach \i in {1,...,#2} {
					($(\fixname.north east)!{\i/(#2+1)}!(\fixname.south east)$) +(-\bbportlen,0) coordinate (\fixname_out\i') -- +(\bbportlen,0) coordinate (\fixname_out\i)}\fi;
			}}}
	},
	bb name/.style={append after command={\pgfextra{\node[anchor=north] at (\fixname.north) {#1};}}}
}

\usetikzlibrary{arrows,calc,chains,matrix,positioning,scopes,snakes}

%Begin tikz macros
\def\blackbox#1#2#3#4#5{%(width,height), number inputs, number outputs, label, arrow length
  \pgfgetlastxy{\llx}{\lly}%assumes path has been set to a point representing the lower left corner of the box
  \path #1;
  \pgfgetlastxy{\w}{\h}
  \pgfmathsetlengthmacro{\urx}{\llx+\w}
  \pgfmathsetlengthmacro{\ury}{\lly+\h}
  \draw (\llx,\lly) rectangle (\urx,\ury);
  \pgfmathsetlengthmacro{\xave}{(\llx+\urx)/2}
  \pgfmathsetlengthmacro{\yave}{\ury-8}
  \node at (\xave,\yave) {#4};
  \pgfmathsetlengthmacro{\ydiff}{\ury-\lly}
  \pgfmathsetlengthmacro{\lstep}{\ydiff/(#2+1)}
  \pgfmathsetlengthmacro{\rstep}{\ydiff/(#3+1)}
  \ifnum #2=0{}\else{ 
   \foreach \l in {1,...,#2}{
    \draw [->] ($(\llx,\lly)+(-#5/2,0)+\l*(0,\lstep)$) -- ($(\llx,\lly)+(#5/2,0)+\l*(0,\lstep)$);}}\fi
  \ifnum #3=0{}\else{
   \foreach \r in {1,...,#3}{
    \draw [->] ($(\urx,\ury)+(-#5/2,0)-\r*(0,\rstep)$) -- ($(\urx,\ury)+(#5/2,0)-\r*(0,\rstep)$);}}\fi
}

\def\blackboxinners#1#2#3#4#5{%(width,height), number inputs, number outputs, label, arrow length
  \pgfgetlastxy{\llx}{\lly}%assumes path has been set to a point representing the lower left corner of the box
  \path #1;
  \pgfgetlastxy{\w}{\h}
  \pgfmathsetlengthmacro{\urx}{\llx+\w}
  \pgfmathsetlengthmacro{\ury}{\lly+\h}
  \draw (\llx,\lly) rectangle (\urx,\ury);
  \pgfmathsetlengthmacro{\xave}{(\llx+\urx)/2}
  \pgfmathsetlengthmacro{\yave}{\ury-8}
  \node at (\xave,\yave) {#4};
  \pgfmathsetlengthmacro{\ydiff}{\ury-\lly}
  \pgfmathsetlengthmacro{\lstep}{\ydiff/(#2+1)}
  \pgfmathsetlengthmacro{\rstep}{\ydiff/(#3+1)}
  \ifnum #2=0{}\else{ 
   \foreach \l in {1,...,#2}{
    \pgfmathsetlengthmacro{\newx}{\llx+#5*28.45274/2}
    \pgfmathsetlengthmacro{\newy}{\lly+\l*\lstep}
    \node at ($(\newx,\newy)+(-1.5,\l*12-\l*\lstep)$) {\tiny$(\pgfmathparse{\newx/28.45274}\pgfmathresult cm,\pgfmathparse{\newy/28.45274}\pgfmathresult cm)$};
    \draw [->] ($(\llx,\lly)+(-#5/2,0)+\l*(0,\lstep)$) -- ($(\llx,\lly)+(#5/2,0)+\l*(0,\lstep)$);}}\fi
  \ifnum #3=0{}\else{
   \foreach \r in {1,...,#3}{
    \pgfmathsetlengthmacro{\newx}{\urx-#5*28.45274/2}
    \pgfmathsetlengthmacro{\newy}{\ury-\r*\rstep}
    \node at ($(\newx,\newy)+(1.5,-\r*12+\r*\rstep)$) {\tiny $(\pgfmathparse{\newx/28.45274}\pgfmathresult cm,\pgfmathparse{\newy/28.45274}\pgfmathresult cm)$};
    \draw [->] ($(\urx,\ury)+(-#5/2,0)-\r*(0,\rstep)$) -- ($(\urx,\ury)+(#5/2,0)-\r*(0,\rstep)$);}}\fi
}

\def\blackboxouters#1#2#3#4#5{%(width,height), number inputs, number outputs, label, arrow length
  \pgfgetlastxy{\llx}{\lly}%assumes path has been set to a point representing the lower left corner of the box
  \path #1;
  \pgfgetlastxy{\w}{\h}
  \pgfmathsetlengthmacro{\urx}{\llx+\w}
  \pgfmathsetlengthmacro{\ury}{\lly+\h}
  \draw (\llx,\lly) rectangle (\urx,\ury);
  \pgfmathsetlengthmacro{\xave}{(\llx+\urx)/2}
  \pgfmathsetlengthmacro{\yave}{\ury-8}
  \node at (\xave,\yave) {#4};
  \pgfmathsetlengthmacro{\ydiff}{\ury-\lly}
  \pgfmathsetlengthmacro{\lstep}{\ydiff/(#2+1)}
  \pgfmathsetlengthmacro{\rstep}{\ydiff/(#3+1)}
  \ifnum #2=0{}\else{ 
   \foreach \l in {1,...,#2}{
    \pgfmathsetlengthmacro{\newx}{\llx-#5*28.45274/2}
    \pgfmathsetlengthmacro{\newy}{\lly+\l*\lstep}
    \node at ($(\newx,\newy)+(-1.5,\l*12-\l*\lstep)$) {\tiny$(\pgfmathparse{\newx/28.45274}\pgfmathresult cm,\pgfmathparse{\newy/28.45274}\pgfmathresult cm)$};
    \draw [->] ($(\llx,\lly)+(-#5/2,0)+\l*(0,\lstep)$) -- ($(\llx,\lly)+(#5/2,0)+\l*(0,\lstep)$);}}\fi
  \ifnum #3=0{}\else{
   \foreach \r in {1,...,#3}{
    \pgfmathsetlengthmacro{\newx}{\urx+#5*28.45274/2}
    \pgfmathsetlengthmacro{\newy}{\ury-\r*\rstep}
    \node at ($(\newx,\newy)+(1.5,-\r*12+\r*\rstep)$) {\tiny $(\pgfmathparse{\newx/28.45274}\pgfmathresult cm,\pgfmathparse{\newy/28.45274}\pgfmathresult cm)$};
    \draw [->] ($(\urx,\ury)+(-#5/2,0)-\r*(0,\rstep)$) -- ($(\urx,\ury)+(#5/2,0)-\r*(0,\rstep)$);}}\fi
}


\def\dashblackbox#1#2#3#4#5{%(width,height), number inputs, number outputs, label, arrow length
  \pgfgetlastxy{\llx}{\lly}%assumes path has been set to a point representing the lower left corner of the box
  \path #1;
  \pgfgetlastxy{\w}{\h}
  \pgfmathsetlengthmacro{\urx}{\llx+\w}
  \pgfmathsetlengthmacro{\ury}{\lly+\h}
  \draw [dashed] (\llx,\lly) rectangle (\urx,\ury);
  \pgfmathsetlengthmacro{\xave}{(\llx+\urx)/2}
  \pgfmathsetlengthmacro{\yave}{\ury-8}
  \node at (\xave,\yave) {#4};
  \pgfmathsetlengthmacro{\ydiff}{\ury-\lly}
  \pgfmathsetlengthmacro{\lstep}{\ydiff/(#2+1)}
  \pgfmathsetlengthmacro{\rstep}{\ydiff/(#3+1)}
  \ifnum #2=0{}\else{ 
   \foreach \l in {1,...,#2}{
    \draw [->] ($(\llx,\lly)+(-#5/2,0)+\l*(0,\lstep)$) -- ($(\llx,\lly)+(#5/2,0)+\l*(0,\lstep)$);}}\fi
  \ifnum #3=0{}\else{
   \foreach \r in {1,...,#3}{
    \draw [->] ($(\urx,\ury)+(-#5/2,0)-\r*(0,\rstep)$) -- ($(\urx,\ury)+(#5/2,0)-\r*(0,\rstep)$);}}\fi
}

\def\directarc#1#2{%left coordinate, right coordinate
  \path #1;
  \pgfgetlastxy{\lx}{\ly}
  \path #2;
  \pgfgetlastxy{\rx}{\ry}
  \pgfmathsetlengthmacro{\xave}{(\lx+\rx)/2}
  \draw #1 .. controls (\xave,\ly) and (\xave,\ry) .. #2;
}

\def\loopright#1#2#3{%upper coordinate, lower coordinate, stretch width
  \path #1;
  \pgfgetlastxy{\ux}{\uy}
  \path #2;
  \pgfgetlastxy{\lx}{\ly}
  \pgfmathsetlengthmacro{\maxx}{max(\ux,\lx)}
  \pgfmathsetlengthmacro{\farx}{\maxx+#3}
  \draw #1 .. controls (\farx,\uy) and (\farx,\ly) .. #2;
}

\def\loopleft#1#2#3{%upper coordinate, lower coordinate, stretch width
  \path #1;
  \pgfgetlastxy{\ux}{\uy}
  \path #2;
  \pgfgetlastxy{\lx}{\ly}
  \pgfmathsetlengthmacro{\minx}{min(\ux,\lx)}
  \pgfmathsetlengthmacro{\farx}{\minx-#3}
  \draw #1 .. controls (\farx,\uy) and (\farx,\ly) .. #2;
}

\def\fancyarc#1#2#3#4{%upper coordinate, lower coordinate, stretch width, max height adjust
  \path #1;
  \pgfgetlastxy{\ux}{\uy}
  \path #2;
  \pgfgetlastxy{\lx}{\ly}
  \pgfmathsetlengthmacro{\xave}{(\lx+\ux)/2}
%  \node at (\lx,\ly+20){\tiny $\pgfmathparse{\lx/28.45274}\pgfmathresult cm$,\hsp$\pgfmathparse{\ux/28.45274}\pgfmathresult cm$};
%  \node at (\xave,\ly+50){\tiny $\pgfmathparse{\xave/28.45274}\pgfmathresult cm$};
  \pgfmathsetlengthmacro{\yave}{(\ly+\uy)/2+#4}
  \loopleft{#1}{(\xave,\yave)}{#3}
  \loopright{#2}{(\xave,\yave)}{#3}
}

\def\delaynode#1{%coordinates
   \filldraw[black] #1 circle (2pt);
}

\def\activetikz#1{$$\begin{tikzpicture}#1\end{tikzpicture}$$}
\def\inactivetikz#1{\begin{center}\fbox{Tikz picture exists but is not being displayed}\end{center}}
%End tikz macros

\newcommand{\vinp}[1]{\overline{\inp{#1}}}
\newcommand{\voutp}[1]{\overline{\outp{#1}}}
%\newcommand{\inp}[1]{#1^{\textnormal{in}}}
%\newcommand{\outp}[1]{#1^{\textnormal{out}}}
\newcommand{\inp}[1]{#1^-}
\newcommand{\outp}[1]{#1^+}

% \def\bhline{\Xhline{2\arrayrulewidth}}
% \def\bbhline{\Xhline{2.5\arrayrulewidth}}
\def\alg{{\text \textendash}\Cat{Alg}}
\def\To{\xrightarrow}
\def\ul{\underline}
\def\List{\textnormal{List}}

\newcommand{\erase}[1]{{}}
\def\NN{\mathbb{N}}
\def\ss{\subseteq}
